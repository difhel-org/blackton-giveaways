var e,t,s,a,n,r=Object.defineProperty,i=(e,t,s)=>(((e,t,s)=>{t in e?r(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s})(e,"symbol"!=typeof t?t+"":t,s),s),o=(e,t,s)=>{if(t.has(e))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(e):t.set(e,s)},c=(e,t,s)=>(((e,t,s)=>{if(!t.has(e))throw TypeError("Cannot "+s)})(e,t,"access private method"),s);import{r as l,a as d,R as u}from"./react-BaJRSMKB.js";import{L as h}from"./lottie-qFjY609k.js";import{p as m}from"./animationParty-BlkckteE.js";import{s as x}from"./animationSad-dh3UVT3t.js";import{g as f}from"./animationGem-CUNHsIGX.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver((e=>{for(const s of e)if("childList"===s.type)for(const e of s.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)})).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?t.credentials="include":"anonymous"===e.crossOrigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();var g={exports:{}},_={},w=l,j=Symbol.for("react.element"),p=Symbol.for("react.fragment"),v=Object.prototype.hasOwnProperty,y=w.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,b={key:!0,ref:!0,__self:!0,__source:!0};function k(e,t,s){var a,n={},r=null,i=null;for(a in void 0!==s&&(r=""+s),void 0!==t.key&&(r=""+t.key),void 0!==t.ref&&(i=t.ref),t)v.call(t,a)&&!b.hasOwnProperty(a)&&(n[a]=t[a]);if(e&&e.defaultProps)for(a in t=e.defaultProps)void 0===n[a]&&(n[a]=t[a]);return{$$typeof:j,type:e,key:r,ref:i,props:n,_owner:y.current}}_.Fragment=p,_.jsx=k,_.jsxs=k,g.exports=_;var C=g.exports,N={},$=d;N.createRoot=$.createRoot,N.hydrateRoot=$.hydrateRoot;class P{constructor(t){o(this,e),o(this,s),o(this,n),i(this,"baseUrl"),i(this,"initData"),this.baseUrl="https://tgbot.blackonthe.casino/giveaways",this.initData=t}async getGiveaway(n){return await c(this,e,t).call(this,await c(this,s,a).call(this,"getGiveawayInfo",{giveaway_id:n}))}async join(e){return await new Promise((e=>setTimeout(e,1e3))),{ok:!0}}}e=new WeakSet,t=function(e,t=!1){return e.error?{ok:!1,error:e.detail}:{ok:!0,response:t?e:e.response}},s=new WeakSet,a=async function(e,t={}){try{const s=new URLSearchParams(t).toString(),a=await fetch(`${this.baseUrl}/${e}?${s}`,{headers:{Authorization:`TGMA ${this.initData}`}});return await a.json()}catch(s){console.error(`Failed to call API method ${e}`,s)}},n=new WeakSet;const A=()=>{const{initData:e}=S();return new P(e)},B=l.createContext({}),D=()=>{const e=l.useContext(B),{value:t,setter:s}=e.currentPage;return{currentPage:t,setCurrentPage:s}},R=()=>{const e=l.useContext(B).giveaway,t=A();return{giveaway:e.value,fetchGiveaway:async s=>{const a=await t.getGiveaway(s);if(!a.ok)throw new Error("Failed to fetch giveaway");return e.setter({...a.response,id:s}),a.response}}},S=()=>{const e=l.useContext(B).initData;return{initData:e.value,setInitData:e.setter}},I=()=>{const e=l.useContext(B).userId;return{userId:e.value,setUserId:e.setter}},L="Wr9fYa_avatar",E=({id:e})=>C.jsx("img",{src:`https://tgbot.blackonthe.casino/giveaways/getAvatar?id=${e}`,className:L}),q="PRzcYq_activeButton",O="PRzcYq_channel",M="PRzcYq_channelBlock",T="PRzcYq_inactiveButton",F=({channel:e,joined:t})=>C.jsxs("div",{className:O,onClick:()=>{window.open(e.channel_link,"_blank")},children:[C.jsxs("div",{className:M,children:[C.jsx(E,{id:e.channel_id}),e.channel_name]}),t?C.jsx("button",{className:T,children:"Вы подписаны"}):C.jsx("button",{className:q,children:"Подписаться"})]}),W="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20100%20100'%20preserveAspectRatio='xMidYMid'%20width='200'%20height='200'%20style='shape-rendering:%20auto;%20display:%20block;%20background:%20transparent;'%20xmlns:xlink='http://www.w3.org/1999/xlink'%3e%3cg%3e%3cpath%20style='transform:scale(0.8);transform-origin:50px%2050px'%20stroke-linecap='round'%20d='M24.3%2030C11.4%2030%205%2043.3%205%2050s6.4%2020%2019.3%2020c19.3%200%2032.1-40%2051.4-40%20C88.6%2030%2095%2043.3%2095%2050s-6.4%2020-19.3%2020C56.4%2070%2043.6%2030%2024.3%2030z'%20stroke-dasharray='42.76482137044271%2042.76482137044271'%20stroke-width='8'%20stroke='%23eeeeee'%20fill='none'%3e%3canimate%20values='0;256.58892822265625'%20keyTimes='0;1'%20dur='1s'%20repeatCount='indefinite'%20attributeName='stroke-dashoffset'%3e%3c/animate%3e%3c/path%3e%3cg%3e%3c/g%3e%3c/g%3e%3c!--%20[ldio]%20generated%20by%20https://loading.io%20--%3e%3c/svg%3e",U="d1X8-a_buttonClicked",z="d1X8-a_channelsBlock",G="d1X8-a_deadline",Y="d1X8-a_giveaway",X="d1X8-a_header",Z="d1X8-a_participateButton",H=()=>{const e=A(),{setCurrentPage:t}=D(),{giveaway:s}=R();if(!s)return null;const a=new Date(1e3*s.deadline.time),n=`${a.getDate()} ${["января","февраля","марта","апреля","мая","июня","июля","августа","сентября","октября","ноября","декабря"][a.getMonth()]} в ${a.getHours()}:${a.getMinutes()}`,[r,i]=l.useState(!1);return C.jsxs("div",{className:Y,children:[C.jsx("div",{className:X}),C.jsxs("h1",{children:["Розыгрыш ",s.amount," 💎"]}),C.jsx("span",{children:s.winners_count>1?`${s.winners_count} победителей разделят ${s.amount} алмазов ($${s.amount}) в BlackTON Casino, каждый получит по ${s.amount/s.winners_count} 💎.`:`Один победитель получит ${s.amount} алмазов`}),C.jsx("br",{}),C.jsxs("span",{children:["Подпишитесь на канал",s.channels.length>1&&"ы"," ниже и нажмите ",C.jsx("b",{children:'"Принять участие"'}),":"]}),C.jsx("br",{}),C.jsx("div",{className:z,children:s.channels.map((e=>C.jsx(F,{channel:e,joined:s.subscription_status[e.channel_id]||!1},e.channel_id)))}),C.jsxs("span",{className:G,children:["Бот автоматически подведет итоги розыгрыша ",C.jsx("b",{children:n}),"."]}),C.jsx("button",{className:`${Z} ${r?U:""}`,onClick:()=>{i(!0),e.join(s.id).then((()=>t("showResults")))},children:r?C.jsx("img",{src:W}):"Принять участие"})]})},V="cuBLlq_closeButton",J="cuBLlq_lottie",K="cuBLlq_registrationSuccess",Q=()=>{const{giveaway:e}=R();if(!e)return null;const t=new Date(1e3*e.deadline.time),s=`${t.getDate()} ${["января","февраля","марта","апреля","мая","июня","июля","августа","сентября","октября","ноября","декабря"][t.getMonth()]} в ${t.getHours()}:${t.getMinutes()}`;return C.jsxs("div",{className:K,children:[C.jsx(h,{animationData:m,className:J}),C.jsx("h1",{children:"Вы участвуете"}),C.jsxs("span",{children:["Бот автоматически подведет итоги розыгрыша ",C.jsx("b",{children:s}),"."]}),C.jsx("button",{className:V,onClick:window.close,children:"Закрыть"})]})},ee="_4sBAbW_closeButton",te="_4sBAbW_lottie",se="_4sBAbW_registrationFailed",ae=()=>{const{setCurrentPage:e}=D();return C.jsxs("div",{className:se,children:[C.jsx(h,{animationData:x,className:te}),C.jsx("h1",{children:"Не удалось зарегистрироваться"}),C.jsx("span",{children:"Подпишитесь на все каналы в списке."}),C.jsx("button",{className:ee,onClick:()=>{e("giveaway")},children:"Вернуться"})]})},ne="SFNfsq_loader",re=()=>C.jsx("div",{className:ne,children:C.jsx("img",{src:W})}),ie="_1L8oCq_closeButton",oe="_1L8oCq_lottie",ce="_1L8oCq_showResults",le="_1L8oCq_usersBlock",de="_4uZhda_index",ue="_4uZhda_me",he="_4uZhda_user",me="_4uZhda_userBlock",xe=({user:e,isMe:t,index:s})=>C.jsx("div",{className:`${he} ${t?ue:""}`,children:C.jsxs("div",{className:me,children:[C.jsxs("span",{className:de,children:[s,"."]}),C.jsx(E,{id:e.id}),e.name]})}),fe=()=>{const{giveaway:e}=R();if(!e)return null;if("finish"!==e.status)return"Розыгрыш еще не завершен";const t=e.participants.filter((e=>e.is_winner)),{userId:s}=I(),a=t.some((e=>e.id===s));return C.jsxs("div",{className:ce,children:[a?C.jsxs(C.Fragment,{children:[C.jsx(h,{animationData:f,className:oe}),C.jsx("h1",{children:"Вы победитель! 🎉"})]}):C.jsxs(C.Fragment,{children:[C.jsx(h,{animationData:x,className:oe}),C.jsx("h1",{children:"Не в этот раз"})]}),C.jsx("span",{children:e.winners_count>1?`${e.winners_count} победителей разделили ${e.amount} алмазов ($${e.amount}) в BlackTON Casino, каждый получил по ${e.amount/e.winners_count} 💎.`:`Один победитель получил ${e.amount} алмазов.`}),C.jsx("div",{className:le,children:t.map(((e,t)=>C.jsx(xe,{user:e,isMe:e.id===s,index:t+1},e.id)))}),C.jsx("button",{className:ie,onClick:window.close,children:"Закрыть"})]})};function ge(){const{currentPage:e,setCurrentPage:t}=D(),{fetchGiveaway:s}=R(),{initData:a,setInitData:n}=S(),{userId:r,setUserId:i}=I();if(l.useEffect((()=>{n("query_id=AAE0IJVRAAAAADQglVEelT2z&user=%7B%22id%22%3A1368727604%2C%22first_name%22%3A%22Mark%22%2C%22last_name%22%3A%22%22%2C%22username%22%3A%22difhel%22%2C%22language_code%22%3A%22en%22%2C%22is_premium%22%3Atrue%2C%22allows_write_to_pm%22%3Atrue%7D&auth_date=1718003686&hash=0891082f1d0e176d40c9bb896388676317923cbc6f918e6cff928d737ccd2691");i(1368727604)})),!a||!r)return null;switch(e){case"loader":return s("be040e00-942c-4844-a1a8-5ef094e1ba6f").then((e=>{"finish"===e.status?t("showResults"):t("giveaway")})),C.jsx(re,{});case"giveaway":return C.jsx(H,{});case"registrationSuccess":return C.jsx(Q,{});case"registrationFailed":return C.jsx(ae,{});case"showResults":return C.jsx(fe,{});default:return C.jsxs("div",{children:['Error: unknown state "',e,'" :(']})}}const _e=({children:e})=>{const[t,s]=l.useState("loader"),[a,n]=l.useState(null),[r,i]=l.useState(null),[o,c]=l.useState(null),d={currentPage:{value:t,setter:s},giveaway:{value:a,setter:n},initData:{value:r,setter:i},userId:{value:o,setter:c}};return C.jsx(B.Provider,{value:d,children:e})};N.createRoot(document.getElementById("root")).render(C.jsx(u.StrictMode,{children:C.jsx(_e,{children:C.jsx(ge,{})})}));
